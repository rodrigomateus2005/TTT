var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var C_Empre = /** @class */ (function (_super) {
    __extends(C_Empre, _super);
    function C_Empre() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(C_Empre.prototype, "txtCNPJ", {
        get: function () {
            return window['txtCNPJ_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtIE", {
        get: function () {
            return window['txtIE_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtIM", {
        get: function () {
            return window['txtIM_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtRazaoSocial", {
        get: function () {
            return window['txtRazaoSocial_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtNomeFantasia", {
        get: function () {
            return window['txtNomeFantasia_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCep", {
        get: function () {
            return window['txtCep_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCodPostal", {
        get: function () {
            return window['txtCodPostal_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCidade", {
        get: function () {
            return window['txtCidade_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtPais", {
        get: function () {
            return window['txtPais_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtNumeroMatriz", {
        get: function () {
            return window['txtNumeroMatriz_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "cboTipoEmpresaMulti", {
        get: function () {
            return window['cboTipoEmpresaMulti_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "lstRegimeIncidencia", {
        //get lstRegimeTributario(): MouraRadioButtonList {
        //    return window['lstRegimeTributario_Object'];
        //}
        get: function () {
            return window['lstRegimeIncidencia_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "cboTipoCadastroNFP", {
        get: function () {
            return window['cboTipoCadastroNFP_comboBox'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "cboIndicadorCriterio", {
        get: function () {
            return window['cboIndicadorCriterio_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "chkUtilizarSPED", {
        get: function () {
            return window['chkUtilizarSPED_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "tab", {
        get: function () {
            return window['tab_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtNomeContabilista", {
        get: function () {
            return window['txtNomeContabilista_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCPFContabilista", {
        get: function () {
            return window['txtCPFContabilista_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtContabilistaCRC", {
        get: function () {
            return window['txtContabilistaCRC_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCNPJEscritorio", {
        get: function () {
            return window['txtCNPJEscritorio_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioCEP", {
        get: function () {
            return window['txtEscritorioCEP_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioEndereco", {
        get: function () {
            return window['txtEscritorioEndereco_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioNumero", {
        get: function () {
            return window['txtEscritorioNumero_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioBairro", {
        get: function () {
            return window['txtEscritorioBairro_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioCidade", {
        get: function () {
            return window['txtEscritorioCidade_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioRazao_Social", {
        get: function () {
            return window['txtEscritorioRazao_Social_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioFone", {
        get: function () {
            return window['txtEscritorioFone_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtEscritorioMail", {
        get: function () {
            return window['txtEscritorioMail_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "btnAtualizarNumeroMaquinas", {
        get: function () {
            return window['btnAtualizarNumeroMaquinas_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCodigo", {
        get: function () {
            return window['txtCodigo_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "mdMaquinas", {
        get: function () {
            return window['mdMaquinas_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "lblSenha", {
        get: function () {
            return $('#lblSenha')[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtSenha", {
        get: function () {
            return window['txtSenha_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "btnGravar", {
        get: function () {
            return window['btnGravar_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "btnCancelar", {
        get: function () {
            return window['btnCancelar_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtAliquota", {
        //get imgUsuario(): HTMLImageElement {
        //    return <HTMLImageElement>$("#imgUsuario_img_I")[0];
        //}
        get: function () {
            return window['txtAliquota_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtMsgInfCompl", {
        get: function () {
            return window['txtMsgInfCompl_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "agp1", {
        get: function () {
            return $('#agpC1_Label')[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtUsuario_AT", {
        get: function () {
            return window['txtUsuario_AT_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtSenha_AT", {
        get: function () {
            return window['txtSenha_AT_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtCapital_Social", {
        get: function () {
            return window['txtCapital_Social_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "cboUF_IEOutros", {
        get: function () {
            return window['cboUF_IEOutros_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtIEOutros", {
        get: function () {
            return window['txtIEOutros_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "txtDadosAdicionais_IEOutros", {
        get: function () {
            return window['txtDadosAdicionais_IEOutros_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "gridIEOutros", {
        get: function () {
            return window['gridIEOutros_Object'];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "InscricoesEstaduais_Outros", {
        get: function () {
            if (!this.GetScope()["InscricoesEstaduais_Outros"]) {
                this.GetScope()["InscricoesEstaduais_Outros"] = {};
            }
            return this.GetScope()["InscricoesEstaduais_Outros"];
        },
        set: function (value) {
            this.GetScope()["InscricoesEstaduais_Outros"] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(C_Empre.prototype, "InscricaoEstadual_Outros", {
        get: function () {
            return this.GetScope()["InscricaoEstadual_Outros"];
        },
        set: function (value) {
            this.GetScope()["InscricaoEstadual_Outros"] = value;
        },
        enumerable: true,
        configurable: true
    });
    C_Empre.prototype.Init = function () {
        _super.prototype.Init.call(this);
        if (this.txtCep) {
            adicionarEventoMoura(this.txtCep.PesquisouCEP, this.OnConsultarCEP, this);
        }
        if (this.txtRazaoSocial) {
            adicionarEventoMoura(this.txtRazaoSocial.TextChanged, this.OnDigitouRazaoSocial, this);
        }
        if (this.txtPais) {
            adicionarEventoMoura(this.txtPais.Procurou, this.OnMudouPais, this);
        }
        if (this.btnAtualizarNumeroMaquinas) {
            adicionarEventoMoura(this.btnAtualizarNumeroMaquinas.Click, this.OnClickAtualizarNumeroMaquinas, this);
        }
        if (this.btnGravar) {
            adicionarEventoMoura(this.btnGravar.Click, this.OnClickGravarNumeroMaquinas, this);
        }
        if (this.btnCancelar) {
            adicionarEventoMoura(this.btnCancelar.Click, this.OnClickCancelarNumeroMaquinas, this);
        }
        if (this.txtAliquota) {
            adicionarEventoMoura(this.txtAliquota.LostFocus, this.HabilitarTxtFazenda, this);
        }
        if (this.cboTipoEmpresaMulti) {
            adicionarEventoMoura(this.cboTipoEmpresaMulti.SelectedItemChanged, this.ValidarTipoEmpresa, this);
        }
        if (this.txtNumeroMatriz) {
            adicionarEventoMoura(this.txtNumeroMatriz.AntesAbrirProcura, this.OntxtNumeroMatrizAntesAbrirProcura, this);
            adicionarEventoMoura(this.txtNumeroMatriz.Procurou, this.OntxtNumeroMatrizProcurou, this);
        }
        if (this.gridIEOutros) {
            adicionarEventoMoura(this.gridIEOutros.Validando, this.OnValidandoIEOutros, this);
        }
    };
    C_Empre.prototype.OnPageLoad = function () {
        _super.prototype.OnPageLoad.call(this);
        //this.txtNumeroMatriz.Enabled = false;
        if (!this.GetScope().MudouTipo) {
            this.GetScope().MudouTipo = $.proxy(this.MudouTipo, this);
            this.GetScope().$watch(function (scope) { return scope.Entity.Tipo; }, this.GetScope().MudouTipo);
        }
        if (!this.GetScope().MudouTipoRegimeTributario) {
            this.GetScope().MudouTipoRegimeTributario = $.proxy(this.MudouTipoRegimeTributario, this);
            this.GetScope().$watch(function (scope) { return scope.Entity.Reg_Trib; }, this.GetScope().MudouTipoRegimeTributario);
        }
        //Aba Fazenda
        this.txtMsgInfCompl.Disabled = true;
        if (ValoresSismoura.ConfiguracoesRetaguarda.EstabelecimentoEnum == 10 /* Fazenda */) {
            this.tab.AlterarVisibleAba("AbaFazenda", true);
            this.tab.AlterarVisibleAba("AbaFarmacia", false);
        }
        else {
            this.tab.AlterarVisibleAba("AbaFazenda", false);
            this.tab.AlterarVisibleAba("AbaFarmacia", true);
        }
        if (ValoresSismoura.Sistema_Pais == 607 /* Portugal */) {
            this.AlterarVisiblePortugal(true);
        }
        else {
            this.AlterarVisiblePortugal(false);
        }
        //this.OnDepoisLimpar(this.GetScope().Entity);
        this.habilitaDesabilitaCampos_IEOutros(false);
    };
    C_Empre.prototype.OntxtNumeroMatrizAntesAbrirProcura = function (s, e) {
        e.Cancelar = false;
        this.txtNumeroMatriz.AddParametro("tipo_empresa", "" + this.cboTipoEmpresaMulti.GetValue());
        this.txtNumeroMatriz.AddParametro("isNumeroMatriz", "1");
    };
    C_Empre.prototype.OntxtNumeroMatrizProcurou = function (s, e) {
        if (this.txtNumeroMatriz.GetText().CNum() <= 0)
            return;
        var param = {
            tipoEmpresa: this.cboTipoEmpresaMulti.GetValue().CNum(),
            codEmpresa: this.txtNumeroMatriz.GetText().CNum()
        };
        if (!this.ExecutarFuncaoServerSideSynch("ValidarEmpresaMatriz", param)) {
            MostrarAlerta("Só será permitido informar uma Empresa do Tipo Matriz.");
            this.txtNumeroMatriz.Limpar();
            this.txtNumeroMatriz.Focus();
        }
    };
    C_Empre.prototype.ValidarTipoEmpresa = function () {
        if (this.txtNumeroMatriz.GetText() != "") {
            this.txtNumeroMatriz.SetText("");
            this.txtNumeroMatriz.LabelResultado.textContent = "";
        }
        if (this.cboTipoEmpresaMulti.GetValue() == 0 && this.cboTipoEmpresaMulti.GetText() == "Filial") {
            this.txtNumeroMatriz.Obrigatorio = true;
            this.txtNumeroMatriz.Enabled = true;
            this.txtNumeroMatriz.PermitirProcurar = true;
        }
        else {
            this.txtNumeroMatriz.Obrigatorio = false;
            this.txtNumeroMatriz.Enabled = false;
            //this.txtNumeroMatriz.PermitirProcurar = false;
        }
    };
    C_Empre.prototype.OnClickGravarNumeroMaquinas = function (s, e) {
        e.processOnServer = false;
        var parametros;
        parametros = {
            codigo: this.txtCodigo.GetText(),
            nomeTela: ValoresSismoura.NomeTela,
            codUsuario: ValoresSismoura.UsuarioLogado
        };
        var retorno = this.ExecutarFuncaoServerSideSynch("Retorna_Empresa_Senha", parametros);
        if (retorno) {
            MostrarMensagem("A quantidade de máquinas foi atualizada!");
            this.mdMaquinas.Hide();
        }
        else {
            MostrarAlerta("A Senha informada é inválida!");
        }
    };
    C_Empre.prototype.OnClickCancelarNumeroMaquinas = function (s, e) {
        e.processOnServer = false;
        this.mdMaquinas.Hide();
    };
    C_Empre.prototype.OnClickAtualizarNumeroMaquinas = function (s, e) {
        e.processOnServer = false;
        if (!(this.txtCodigo.GetText() == "")) {
            var parametros;
            parametros = {
                nomeTela: ValoresSismoura.NomeTela,
                codUsuario: ValoresSismoura.UsuarioLogado
            };
            var retorno = this.ExecutarFuncaoServerSideSynch("QuantidadeMaquinasEmpresa", parametros);
            if (retorno) {
                MostrarMensagem("Quantidade de máquinas alterada com sucesso!");
            }
            else {
                var senha = this.ExecutarFuncaoServerSideSynch("CodigoModalQuantidadeMaquinasEmpresa", parametros);
                this.lblSenha.innerHTML = senha;
                this.lblSenha.innerText = senha;
                this.txtSenha.Limpar();
                this.mdMaquinas.Show();
            }
        }
    };
    C_Empre.prototype.OnDepoisBuscarExistente = function (Entidade) {
        var parametros;
        _super.prototype.OnDepoisBuscarExistente.call(this, Entidade);
        this.SetEnabledBtnAtualizarMaquinas(Entidade);
        this.HabilitarTxtFazenda(Entidade);
        if (!Entidade.Pais && Entidade.CidadeEntity.Nome_Pais == "Brasil") {
            Entidade.Pais = 30;
        }
        if (Entidade.Tipo_Empresa == 0) {
            this.txtNumeroMatriz.Obrigatorio = true;
            this.txtNumeroMatriz.Enabled = true;
        }
        this.PreencherGrade_IEOutros();
        this.habilitaDesabilitaCampos_IEOutros(true);
        if (ValoresSismoura.Sistema_Pais == 607 /* Portugal */) {
            this.txtCodPostal.SetText(Entidade.Cep);
        }
    };
    C_Empre.prototype.SetEnabledBtnAtualizarMaquinas = function (Entidade) {
        if (Entidade.Cnpj == "64.152.986/0001-06") {
            $("#" + this.btnAtualizarNumeroMaquinas.ID).attr("Disabled", "true");
        }
        else {
            $("#" + this.btnAtualizarNumeroMaquinas.ID).removeAttr("Disabled");
        }
    };
    C_Empre.prototype.MudouTipoRegimeTributario = function (newValue, oldValue) {
        var parametros = {
            codPais: this.txtPais.GetText().CNum()
        };
        if (this.EntityTela.Reg_Trib == 2 || this.EntityTela.Reg_Trib == 3 || this.ExecutarFuncaoServerSideSynch("MudarConfiguracaoPais", parametros) == 607 /* Portugal */) {
            this.tab.AlterarVisibleAba("AbaSPED", false);
            this.chkUtilizarSPED.Checked = false;
            this.MarcarContadorObrigatorio(false);
            this.cboIndicadorCriterio.Obrigatorio = false;
        }
        else {
            this.tab.AlterarVisibleAba("AbaSPED", true);
            var parametros;
            parametros = {
                codigo: this.EntityTela.Reg_Trib
            };
            var lista = this.ExecutarFuncaoServerSideSynch("GetRegimeIncidencia", parametros);
            this.lstRegimeIncidencia.RemoverTodosItens();
            for (var x = 0; x < lista.length; x++) {
                this.lstRegimeIncidencia.AdicionarItem(lista[x].Descricao, lista[x].Codigo);
            }
            //this.RefreshAngular();
            if (this.EntityTela.Regime_Incidencia != undefined) {
                this.lstRegimeIncidencia.SetValue(this.EntityTela.Regime_Incidencia.toString());
            }
            if (this.lstRegimeIncidencia.GetValue() == null) {
                $('#' + this.lstRegimeIncidencia.ID + '_List_0').attr('checked', 'true');
            }
            if (this.lstRegimeIncidencia.GetValue() == "0") {
                this.cboIndicadorCriterio.Enabled = true;
                this.cboIndicadorCriterio.Obrigatorio = true;
            }
            else {
                this.cboIndicadorCriterio.Enabled = false;
                this.cboIndicadorCriterio.Obrigatorio = false;
            }
            this.chkUtilizarSPED.Checked = true;
            this.MarcarContadorObrigatorio(true);
        }
    };
    C_Empre.prototype.MarcarContadorObrigatorio = function (flag) {
        if (this.txtNomeContabilista) {
            this.txtNomeContabilista.Obrigatorio = flag;
        }
        if (this.txtCPFContabilista) {
            this.txtCPFContabilista.Obrigatorio = flag;
        }
        if (this.txtContabilistaCRC) {
            this.txtContabilistaCRC.Obrigatorio = flag;
        }
        if (this.txtCNPJEscritorio) {
            this.txtCNPJEscritorio.Obrigatorio = flag;
        }
        if (this.txtEscritorioCEP) {
            this.txtEscritorioCEP.Obrigatorio = flag;
        }
        if (this.txtEscritorioEndereco) {
            this.txtEscritorioEndereco.Obrigatorio = flag;
        }
        if (this.txtEscritorioNumero) {
            this.txtEscritorioNumero.Obrigatorio = flag;
        }
        if (this.txtEscritorioBairro) {
            this.txtEscritorioBairro.Obrigatorio = flag;
        }
        if (this.txtEscritorioCidade) {
            this.txtEscritorioCidade.Obrigatorio = flag;
        }
        if (this.txtEscritorioRazao_Social) {
            this.txtEscritorioRazao_Social.Obrigatorio = flag;
        }
        if (this.txtEscritorioFone) {
            this.txtEscritorioFone.Obrigatorio = flag;
        }
        if (this.txtEscritorioMail) {
            this.txtEscritorioMail.Obrigatorio = flag;
        }
    };
    C_Empre.prototype.MudouTipo = function (newValue, oldValue) {
        if (String.IsNullOrWhiteSpace(newValue)) {
            newValue = "J";
        }
        var parametros = {
            codigo: this.EntityTela.Reg_Trib
        };
        if (newValue == "F") {
            this.txtCNPJ.IsCPF = true;
            this.txtIE.SetTextLabelControl("R.G.");
            this.txtNomeFantasia.SetTextLabelControl("Apelido");
            this.txtRazaoSocial.SetTextLabelControl("Nome");
            if (ValoresSismoura.Sistema_Pais == 607 /* Portugal */) {
                this.txtNomeFantasia.Visible = false;
            }
        }
        else {
            this.txtCNPJ.IsCPF = false;
            this.txtIE.SetTextLabelControl("Inscrição Estadual");
            this.txtNomeFantasia.SetTextLabelControl("Nome Fantasia");
            this.txtRazaoSocial.SetTextLabelControl("Razão Social");
            if (ValoresSismoura.Sistema_Pais == 607 /* Portugal */) {
                this.txtNomeFantasia.Visible = true;
            }
        }
        this.EntityTela.Cnpj = this.txtCNPJ.GetText();
        this.RefreshAngular();
    };
    C_Empre.prototype.OnConsultarCEP = function (s, e) {
        if (e.EncontrouEndereco) {
            var entidade = this.GetScope().Entity;
            entidade.Bairro = e.Bairro;
            entidade.Endereco = e.Endereco;
            entidade.Cidade = e.CidadeCodigo;
            entidade.Cep = this.txtCep.GetText();
            this.GetScope().$applyAsync();
        }
        else {
            this.txtCep.Focus();
        }
    };
    C_Empre.prototype.OnDigitouRazaoSocial = function () {
        var entidade = this.GetScope().Entity;
        if (entidade) {
            if (String.IsNullOrWhiteSpace(entidade.Fantasia)) {
                entidade.Fantasia = entidade.Razao_Social;
            }
        }
        this.GetScope().$applyAsync();
    };
    C_Empre.prototype.OnMudouPais = function () {
        var parametros = {
            codPais: this.txtPais.GetText().CNum()
        };
        ValoresSismoura.Sistema_Pais = this.ExecutarFuncaoServerSideSynch("MudarConfiguracaoPais", parametros);
        this.txtCNPJ.AtualizarMascaras();
        this.txtCNPJEscritorio.AtualizarMascaras();
        if (ValoresSismoura.Sistema_Pais == 607 /* Portugal */) {
            this.MarcarContadorObrigatorio(false);
            this.cboIndicadorCriterio.Obrigatorio = false;
            this.AlterarVisiblePortugal(true);
            this.tab.AlterarVisibleAba("AbaSPED", false);
        }
        else {
            if (this.EntityTela.Reg_Trib != 2 && this.EntityTela.Reg_Trib != 3) {
                this.MarcarContadorObrigatorio(true);
                this.AlterarVisiblePortugal(false);
            }
            this.tab.AlterarVisibleAba("AbaSPED", true);
            if (this.lstRegimeIncidencia.GetValue() == "0") {
                this.cboIndicadorCriterio.Enabled = true;
                this.cboIndicadorCriterio.Obrigatorio = true;
            }
            else {
                this.cboIndicadorCriterio.Enabled = false;
                this.cboIndicadorCriterio.Obrigatorio = false;
            }
        }
        this.RefreshAngular();
    };
    C_Empre.prototype.AlterarVisiblePortugal = function (flag) {
        this.txtUsuario_AT.Visible = flag;
        this.txtSenha_AT.Visible = flag;
        this.txtCapital_Social.Visible = flag;
        this.txtIE.Visible = !flag;
        this.txtIM.Visible = !flag;
    };
    //protected OnSelecionouRegimeTrib() {
    //    if (this.lstRegimeTributario.GetValue().CNum() == 2 || this.lstRegimeTributario.GetValue().CNum() == 3) {
    //        this.tab.AlterarVisibleAba("AbaSPED", false);
    //    } else {
    //        this.tab.AlterarVisibleAba("AbaSPED", true);
    //        if (this.lstRegimeTributario.GetValue().CNum() == 1) {
    //        } else if (this.lstRegimeTributario.GetValue().CNum() == 4) {
    //        }
    //    }        
    //}
    C_Empre.prototype.OnAntesSetEntidade = function (eventArg) {
        _super.prototype.OnAntesSetEntidade.call(this, eventArg);
        if (!eventArg.Entidade)
            eventArg.Entidade = {};
        //if (eventArg.Entidade.Reg_Trib != null && eventArg.Entidade.Reg_Trib != undefined) {
        //    this.lstRegimeTributario.SetValue(eventArg.Entidade.Reg_Trib.toString());
        //}
        //if (eventArg.Entidade.Regime_Incidencia != null && eventArg.Entidade.Regime_Incidencia != undefined) {
        //    this.lstRegimeIncidencia.SetValue(eventArg.Entidade.Regime_Incidencia.toString());
        //}
    };
    C_Empre.prototype.OnDepoisLimpar = function (Entity) {
        _super.prototype.OnDepoisLimpar.call(this, Entity);
        Entity.Data_Cadastro_Ecf = new Date();
        Entity.Tipo = "J";
        Entity.Reg_Trib = 2; //null
        this.SetEnabledBtnAtualizarMaquinas(Entity);
        if (this.txtNumeroMatriz.LabelResultado) {
            this.txtNumeroMatriz.LabelResultado.textContent = "";
        }
        this.txtNumeroMatriz.SetText("");
        this.txtNumeroMatriz.Obrigatorio = false;
        //this.imgUsuario.src = "";
        //    if (this.lstRegimeTributario) {
        //        this.lstRegimeTributario.LimparSelecao();
        //    }
        //    if (this.lstRegimeIncidencia) {
        //        this.lstRegimeIncidencia.LimparSelecao();
        //    }
        this.txtMsgInfCompl.Obrigatorio = false;
        this.txtMsgInfCompl.Disabled = true;
        this.habilitaDesabilitaCampos_IEOutros(false);
        this.InscricoesEstaduais_Outros = [];
        this.txtCodPostal.Visible = false;
        if (ValoresSismoura.ConfiguracoesRetaguarda.Sistema_Pais == 607 /* Portugal */) {
            this.txtCep.Visible = false;
            this.txtCodPostal.Visible = true;
            this.txtCodPostal.Limpar();
        }
    };
    C_Empre.prototype.OnAntesGravar = function () {
        _super.prototype.OnAntesGravar.call(this);
        var entidade = this.EntityTela;
        entidade.Regime_Incidencia = +this.lstRegimeIncidencia.GetValue();
        entidade.Cnpj = this.txtCNPJ.GetText();
        //Validacoes aqui
        if (entidade.Tipo_Empresa == 0) {
            if ((entidade.Empresa_Matriz == 0 || entidade.Empresa_Matriz == null) && this.txtNumeroMatriz.Visible) {
                MostrarAlerta("Informe uma empresa Matriz!");
                return false;
            }
        }
        if (this.InscricoesEstaduais_Outros) {
            this.EntityTela.IE_OutrosEstados = this.InscricoesEstaduais_Outros;
        }
        if (ValoresSismoura.Sistema_Pais == 607 /* Portugal */) {
            entidade.Cep = this.txtCodPostal.GetText();
        }
        return true;
    };
    C_Empre.prototype.OnDepoisGravar = function () {
        _super.prototype.OnDepoisGravar.call(this);
        this.PreencherEntidade(this.txtCodigo.GetText());
        return true;
    };
    C_Empre.prototype.HabilitarTxtFazenda = function (entidade) {
        if (!entidade || entidade.Funrural_Aliquota == undefined) {
            entidade = this.GetScope().Entity;
        }
        if (entidade.Funrural_Aliquota != 0 && entidade.Funrural_Aliquota != undefined) {
            this.txtMsgInfCompl.Obrigatorio = true;
            this.txtMsgInfCompl.Disabled = false;
        }
        else {
            this.txtMsgInfCompl.Obrigatorio = false;
            this.txtMsgInfCompl.Disabled = true;
            entidade.Funrural_Mensagem = "";
            this.GetScope().$applyAsync();
        }
    };
    C_Empre.prototype.OnValidandoIEOutros = function (s, e) {
        try {
            var entidade;
            entidade = e.item;
            if (e.index < 0) {
                if (this.txtIEOutros.GetText() == "" && this.txtDadosAdicionais_IEOutros.GetText() == "") {
                    MostrarAlerta("Preencha o campo Inscrição Estadual ou o campo Dados Adicionais!");
                    e.cancelar = true;
                    return;
                }
                if (this.cboUF_IEOutros.GetText() == "") {
                    MostrarAlerta("Preencha o campo corretamente: UF");
                    e.cancelar = true;
                    return;
                }
                var param = {
                    codCidade: this.txtCidade.GetText().CNum()
                };
                var aux = this.ExecutarFuncaoServerSideSynch("GetUFbyCidade", param);
                if (this.cboUF_IEOutros.GetText() == aux) {
                    MostrarAlerta("Não é permitido cadastrar inscrição estadual para a UF da empresa!"); //Valida se o UF é diferente do UF da empresa
                    e.cancelar = true;
                    return;
                }
                var item = this.InscricoesEstaduais_Outros.FirstOrDefault("UF", this.cboUF_IEOutros.GetText());
                if (item) {
                    MostrarAlerta("Já existe uma inscrição estadual cadastrada para esta UF!");
                    e.cancelar = true;
                    return;
                }
                //param  = {
                //    codEmpresa: this.txtCodigo.GetText().CNum(),
                //    UF: this.cboUF_IEOutros.GetText()
                //}
                //if (this.ExecutarFuncaoServerSideSynch("VerificaExistenciaUF_IEOutros", param)) {
                //    MostrarAlerta("Já existe uma inscrição estadual cadastrada para esta UF!");
                //    e.cancelar = true;
                //    return;
                //}
                item = this.InscricoesEstaduais_Outros.FirstOrDefault("IE", this.txtIEOutros.GetText());
                if (item) {
                    MostrarAlerta("Inscrição Estadual cadastrada para a UF: " + item.UF);
                    e.cancelar = true;
                    return;
                }
                //     param  = {
                //        codEmpresa: this.txtCodigo.GetText().CNum(),
                //        IE: this.txtIEOutros.GetText()
                //    }
                //    var aux = this.ExecutarFuncaoServerSideSynch("Valida_IEOutros_Repetida", param);
                //    if (aux != "") {
                //        MostrarAlerta("Inscrição Estadual cadastrada para a UF: " + aux);
                //        e.cancelar = true;
                //        return; 
                //    }
            }
        }
        catch (ex) {
            LogarException(ex);
        }
    };
    C_Empre.prototype.PreencherGrade_IEOutros = function () {
        try {
            var parametros;
            parametros = {
                codEmpresa: this.txtCodigo.GetText().CNum()
            };
            this.InscricoesEstaduais_Outros = this.ExecutarFuncaoServerSideSynch("GetCadastrados_IEOutros", parametros);
        }
        catch (ex) {
            LogarException(ex);
        }
    };
    C_Empre.prototype.habilitaDesabilitaCampos_IEOutros = function (flag) {
        this.cboUF_IEOutros.Enabled = flag;
        this.txtIEOutros.Enabled = flag;
        this.txtDadosAdicionais_IEOutros.Enabled = flag;
        this.gridIEOutros.btnNovo.SetEnabled(flag);
        this.gridIEOutros.btnAdiconar.SetEnabled(flag);
    };
    return C_Empre;
}(MouraPageCadastroAngular));
var c_Empre = new C_Empre();
//# sourceMappingURL=C_Empre.js.map